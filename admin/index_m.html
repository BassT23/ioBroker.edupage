<script type="text/javascript">
    let onChangeFn;

    function load(settings, onChange) {
        onChangeFn = onChange;

        if (!settings) return;

        $('.value').each(function () {
            const $el = $(this);
            const id = $el.attr('id');

            if ($el.attr('type') === 'checkbox') {
                $el.prop('checked', settings[id]);
            } else {
                $el.val(settings[id]);
            }
        });

        // ðŸ”´ WICHTIG: change / input Listener
        $('.value').on('change input', function () {
            onChangeFn(true);
        });

        onChange(false);
        M.updateTextFields();
    }

    function save(callback) {
        const obj = {};

        $('.value').each(function () {
            const $el = $(this);
            const id = $el.attr('id');

            if ($el.attr('type') === 'checkbox') {
                obj[id] = $el.prop('checked');
            } else if ($el.attr('type') === 'number') {
                obj[id] = parseInt($el.val(), 10);
            } else {
                obj[id] = $el.val();
            }
        });

        callback(obj);
    }
</script>
